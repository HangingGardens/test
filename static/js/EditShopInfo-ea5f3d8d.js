import{_ as ae,d as se,J as ne,A as de,a as f,C as R,o as ue,E as r,e as ie,g as t,G as s,t as n,H as u,h as i,M as E,j as re,L as V,ak as N,P as q,T as y,al as pe,b as ce,p as me,l as ve}from"./index-968154d2.js";import{_ as he}from"./defaultImg-4bd84b61.js";import{B as fe}from"./BackIcon-73e4a0f8.js";import{u as A}from"./upload-b20c16ef.js";import{d as ge}from"./category-399ce24a.js";import{b as _e,a as we}from"./shop-fb0ddb4c.js";const F=""+new URL("../images/info-arrow-84b360cc.svg",import.meta.url).href;const b=$=>(me("data-v-0906f736"),$=$(),ve(),$),ye={class:"px-3 text-default text-sm"},Ve={class:"flex-start gap-2 mt-2"},$e={class:"rounded-xl bg-white px-2 py-4 mt-4"},Se={class:"flex-center-bw"},be={class:"key"},Ce=b(()=>t("div",{class:"w-[50px] h-[50px] rounded-xl bg-gray1 text-center text-lg text-[#d9d9d9] font-bold"},[t("img",{src:he})],-1)),ke={class:"flex-center-bw mt-4"},xe={class:"key"},Ie={class:"flex-center-bw mt-4"},Ue={class:"key"},Te={class:"value"},Le={class:"flex-center-bw mt-4"},Re={class:"key"},Ee={class:"value"},Ne={class:"flex-center-bw mt-4"},qe={class:"key"},Ae=V("%"),Fe={class:"flex-center-bw mt-4"},Be={class:"key"},He={class:"value"},Pe={class:"flex-center-bw mt-4"},ze={class:"key"},je={class:"value flex-start gap-1"},Me=b(()=>t("img",{src:F,class:"w-[6px]",alt:""},null,-1)),De={class:"flex-center-bw mt-4"},Ge={class:"key"},Je={class:"flex-center-bw mt-4"},Oe={class:"key"},Qe={class:"value flex-start gap-1"},Ke=b(()=>t("img",{src:F,class:"w-[6px]",alt:""},null,-1)),We={class:"flex-center-bw mt-4"},Xe={class:"key"},Ye=b(()=>t("img",{src:F,class:"w-[6px]",alt:""},null,-1)),Ze={class:"flex-center-bw mt-4"},eo={class:"key"},oo=se({setup($){const{currentLocale:P,changeLocale:to}=ne(),{t:g,messages:z}=de(),j=z.value[P.value].areaList,S=f(!1),p=f(""),c=f(""),[C,k]=R(!1),[x,I]=R(!1),[U,T]=R(!1),a=f({logo:null,storeName:null,openingHours:null,discountRatio:null,classId:1,contact:null,location:null,scenery:null,qrCode:null,contactAddress:null}),B=f([]),M=async()=>{const e=await ge();!e.success||(B.value=(e.data||[]).map(o=>({value:o.id,text:o.name})))},D=e=>e>80?80:e,m=f([]),v=f([]),h=f([]),G=async e=>{const o=await N(e,"shopLogo"),d=await A(o);if(!d.success)return m.value.length-=1;m.value[m.value.length-1]={url:q.imgUrl+d.data}},J=async e=>{const o=await N(e,"shopScenery"),d=await A(o);if(!d.success)return v.value.length-=1;v.value[v.value.length-1]={url:q.imgUrl+d.data}},O=async e=>{const o=await N(e,"shopScenery"),d=await A(o);if(!d.success)return h.value.length-=1;h.value[h.value.length-1]={url:q.imgUrl+d.data}},Q=e=>{if(console.log(e),!e[0].code||!e[1].code)return y(g("common.choose address"));a.value.location=[...new Set(e.map(o=>o.name))].join(""),k(!1)},K=e=>{p.value=e,I(!1)},W=e=>{c.value=e,T(!1)},X=async()=>{if(S.value)return;if(!m.value.length)return y(g("shop.emptyLogo"));if(!a.value.storeName)return y(g("shop.emptyName"));if(!p.value)return y(g("shop.emptyOpenTime"));if(!c.value)return y(g("shop.emptyEndTime"));if(!a.value.discountRatio||a.value.discountRatio<=0)return y(g("shop.emptyRadio"));if(!a.value.classId)return y(g("shop.emptyClass"));S.value=!0,a.value.logo=m.value[0].url,a.value.scenery=v.value.length?v.value[0].url:"",a.value.qrCode=h.value.length?h.value[0].url:"",a.value.openingHours=`${p.value} - ${c.value}`,console.log(a.value);const e=await _e(a.value);S.value=!1,e.success&&pe.back()},Y=async()=>{var o,d,_;const e=await we();if(!(!e.success||!e.data)){if(a.value=e.data,e.data.openingHours){const w=e.data.openingHours.split("-");p.value=w[0].trim(),c.value=w[1].trim()}(o=e.data)!=null&&o.logo&&(m.value[0]={url:e.data.logo}),(d=e.data)!=null&&d.scenery&&(v.value[0]={url:e.data.scenery}),(_=e.data)!=null&&_.qrCode&&(h.value[0]={url:e.data.qrCode})}},Z=()=>{M(),Y()};return ue(()=>{Z()}),(e,o)=>{const d=r("van-uploader"),_=r("VanField"),w=r("van-field"),H=r("van-datetime-picker"),L=r("van-popup"),ee=r("van-dropdown-item"),oe=r("van-dropdown-menu"),te=r("van-area"),le=r("VanButton");return ce(),ie("div",ye,[t("div",Ve,[s(fe),t("div",null,n(e.$t("order.shopInfo")),1)]),t("div",$e,[t("div",Se,[t("div",be,n(e.$t("shop.shopLogo")),1),s(d,{modelValue:m.value,"onUpdate:modelValue":o[0]||(o[0]=l=>m.value=l),accept:"image/*","max-count":1,"preview-size":"50",afterRead:G},{default:u(()=>[Ce]),_:1},8,["modelValue"])]),t("div",ke,[t("div",xe,n(e.$t("shop.shopName")),1),s(_,{class:"value","input-align":"right",modelValue:a.value.storeName,"onUpdate:modelValue":o[1]||(o[1]=l=>a.value.storeName=l),placeholder:e.$t("shop.pleaseInput")},null,8,["modelValue","placeholder"])]),t("div",Ie,[t("div",Ue,n(e.$t("shop.openTime")),1),t("div",Te,[s(w,{"input-align":"right",autocomplete:"off",placeholder:e.$t("shop.pleaseSelect"),disabled:"","model-value":p.value,"onUpdate:model-value":o[2]||(o[2]=l=>p.value=l),onClick:o[3]||(o[3]=l=>i(I)(!0))},null,8,["placeholder","model-value"]),s(L,{round:"",show:i(x),"onUpdate:show":o[6]||(o[6]=l=>E(x)?x.value=l:null),position:"bottom",style:{height:"40%"}},{default:u(()=>[s(H,{modelValue:p.value,"onUpdate:modelValue":o[4]||(o[4]=l=>p.value=l),type:"time",title:"\u9009\u62E9\u65F6\u95F4","min-hour":0,"max-hour":24,onConfirm:K,onCancel:o[5]||(o[5]=l=>i(I)(!1))},null,8,["modelValue"])]),_:1},8,["show"])])]),t("div",Le,[t("div",Re,n(e.$t("shop.endTime")),1),t("div",Ee,[s(w,{"input-align":"right",autocomplete:"off",placeholder:e.$t("shop.pleaseSelect"),disabled:"","model-value":c.value,"onUpdate:model-value":o[7]||(o[7]=l=>c.value=l),onClick:o[8]||(o[8]=l=>i(T)(!0))},null,8,["placeholder","model-value"]),s(L,{round:"",show:i(U),"onUpdate:show":o[11]||(o[11]=l=>E(U)?U.value=l:null),position:"bottom",style:{height:"40%"}},{default:u(()=>[s(H,{modelValue:c.value,"onUpdate:modelValue":o[9]||(o[9]=l=>c.value=l),type:"time",title:"\u9009\u62E9\u65F6\u95F4","min-hour":0,"max-hour":24,onConfirm:W,onCancel:o[10]||(o[10]=l=>i(T)(!1))},null,8,["modelValue"])]),_:1},8,["show"])])]),re(` <div class="flex-center-bw mt-4">
        <div class="key">{{ $t('shop.shopTime') }}</div>
        <VanField class="value" input-align="right" v-model="info.openingHours" :placeholder="$t('shop.pleaseInput')" />
      </div> `),t("div",Ne,[t("div",qe,n(e.$t("shop.shopRateSetting")),1),s(w,{class:"value","input-align":"right",modelValue:a.value.discountRatio,"onUpdate:modelValue":o[12]||(o[12]=l=>a.value.discountRatio=l),type:"digit",placeholder:e.$t("shop.pleaseInputPoint"),formatter:D},{"right-icon":u(()=>[Ae]),_:1},8,["modelValue","placeholder"])]),t("div",Fe,[t("div",Be,n(e.$t("shop.shopCategory")),1),t("div",He,[s(w,{"input-align":"right",autocomplete:"off"},{input:u(()=>[s(oe,{"active-color":"#FEA021"},{default:u(()=>[s(ee,{modelValue:a.value.classId,"onUpdate:modelValue":o[13]||(o[13]=l=>a.value.classId=l),options:B.value},null,8,["modelValue","options"])]),_:1})]),_:1})])]),t("div",Pe,[t("div",ze,n(e.$t("shop.shopPhoto")),1),s(d,{modelValue:v.value,"onUpdate:modelValue":o[14]||(o[14]=l=>v.value=l),accept:"image/*","max-count":1,"preview-size":"50",afterRead:J},{default:u(()=>[t("div",je,[V(n(e.$t("shop.upload"))+" ",1),Me])]),_:1},8,["modelValue"])]),t("div",De,[t("div",Ge,n(e.$t("shop.contact")),1),s(_,{class:"value","input-align":"right",modelValue:a.value.contact,"onUpdate:modelValue":o[15]||(o[15]=l=>a.value.contact=l),placeholder:e.$t("shop.pleaseInput")},null,8,["modelValue","placeholder"])]),t("div",Je,[t("div",Oe,n(e.$t("shop.qrCode")),1),s(d,{modelValue:h.value,"onUpdate:modelValue":o[16]||(o[16]=l=>h.value=l),accept:"image/*","max-count":1,"preview-size":"50",afterRead:O},{default:u(()=>[t("div",Qe,[V(n(e.$t("shop.upload"))+" ",1),Ke])]),_:1},8,["modelValue"])]),t("div",null,[t("div",We,[t("div",Xe,n(e.$t("shop.shopAddress")),1),t("div",{class:"value flex-end gap-1",onClick:o[17]||(o[17]=l=>i(k)(!0))},[V(n(e.$t("shop.edit"))+" ",1),Ye]),s(L,{round:"",show:i(C),"onUpdate:show":o[19]||(o[19]=l=>E(C)?C.value=l:null),position:"bottom",style:{height:"40%"}},{default:u(()=>[s(te,{title:"","area-list":i(j),"columns-placeholder":[e.$t("shop.pleaseSelect"),e.$t("shop.pleaseSelect"),e.$t("shop.pleaseSelect")],"columns-num":"2",onConfirm:Q,onCancel:o[18]||(o[18]=l=>i(k)(!1))},null,8,["area-list","columns-placeholder"])]),_:1},8,["show"])]),s(_,{class:"rounded bg-[#f2f0ef] px-1 py-2 mt-2",readonly:"",modelValue:a.value.location,"onUpdate:modelValue":o[20]||(o[20]=l=>a.value.location=l),placeholder:e.$t("shop.pleaseSelect")},null,8,["modelValue","placeholder"])]),t("div",null,[t("div",Ze,[t("div",eo,n(e.$t("shop.shopSpecificAddress")),1)]),s(_,{class:"rounded bg-[#f2f0ef] px-1 py-2 mt-2",modelValue:a.value.contactAddress,"onUpdate:modelValue":o[21]||(o[21]=l=>a.value.contactAddress=l),placeholder:e.$t("shop.pleaseInput")},null,8,["modelValue","placeholder"])])]),s(le,{class:"btn-orange btn-shadow min-w-[130px] mt-2 block mx-auto",loading:S.value,onClick:X},{default:u(()=>[V(n(e.$t("common.confirm")),1)]),_:1},8,["loading"])])}}}),ro=ae(oo,[["__scopeId","data-v-0906f736"],["__file","/Users/wangkeai/work/xueyan/mai/flashmall-dapp/src/view/shop/EditShopInfo.vue"]]);export{ro as default};
