import{_ as G,d as N,a as r,E as v,b as k,k as R,H as u,g as s,t as y,G as l,L as I,p as Q,l as W,A as ie,ae as re,B as pe,u as ce,ag as A,D as B,w as F,o as ve,e as me,K as fe,h as w,j as M,ak as O,P as K}from"./index-c3baa0c4.js";import{B as ge}from"./BackIcon-02ff58c5.js";import{_ as X}from"./goodsTipsBg-e3ddc51b.js";import{u as J}from"./upload-24ed4024.js";import{c as _e,b as he}from"./goods-4bed5771.js";import{q as we}from"./category-b2d4cf43.js";const ye=p=>(Q("data-v-373c089e"),p=p(),W(),p),xe={class:"w-full min-h-[150px] text-center rounded-xl p-3.5 bg-origin3 relative"},be=ye(()=>s("img",{src:X,class:"absolute top-0 left-0 w-full h-full"},null,-1)),Ve={class:"mb-2.5"},$e=N({props:{name:{type:null,required:!1}},emits:["close","handleLeave","handleDraft"],setup(p,{emit:i}){const m=r(!0);return(x,d)=>{const b=v("VanButton"),V=v("VanPopup");return k(),R(V,{show:m.value,"onUpdate:show":d[2]||(d[2]=f=>m.value=f),style:{background:"transparent",width:"98%","min-width":"280px","max-width":"350px"},"close-on-click-overlay":!0,onClickOverlay:d[3]||(d[3]=()=>i("close"))},{default:u(()=>[s("div",xe,[be,s("div",Ve,y(x.$t("goods.isSaveDraft")),1),l(b,{class:"min-w-[165px] h-[40px] px-[50px] btn-orange btn-shadow text-white rounded-full",onClick:d[0]||(d[0]=()=>i("handleDraft"))},{default:u(()=>[I(y(x.$t("goods.saveDraft")),1)]),_:1}),l(b,{class:"min-w-[165px] h-[40px] px-[50px] bg-white text-primary rounded-full mt-2.5",onClick:d[1]||(d[1]=()=>i("handleLeave"))},{default:u(()=>[I(y(x.$t("goods.notSave")),1)]),_:1})])]),_:1},8,["show"])}}}),ke=G($e,[["__scopeId","data-v-373c089e"],["__file","/Users/wangkeai/work/xueyan/mai/flashmall-dapp/src/view/goods/components/LeaveTipsPop.vue"]]),Ie=""+new URL("../images/0-1564f380.svg",import.meta.url).href;const Y=p=>(Q("data-v-fdcc294a"),p=p(),W(),p),De={class:"w-full min-h-[150px] rounded-xl p-3.5 bg-origin3 relative flex flex-col justify-center text-center"},Le=Y(()=>s("img",{src:X,class:"absolute top-0 left-0 w-full h-full"},null,-1)),Pe=Y(()=>s("div",null,[s("img",{src:Ie,class:"h-[40px] w-auto mx-auto"})],-1)),Ue={class:"mt-2.5"},Re=N({props:{text:{type:null,required:!1}},emits:["close","handleLeave","handleDraft"],setup(p,{emit:i}){const m=r(!0);return(x,d)=>{const b=v("VanPopup");return k(),R(b,{show:m.value,"onUpdate:show":d[0]||(d[0]=V=>m.value=V),style:{background:"transparent",width:"98%","min-width":"280px","max-width":"350px"},"close-on-click-overlay":!0,onClickOverlay:d[1]||(d[1]=()=>i("close"))},{default:u(()=>[s("div",De,[Le,Pe,s("div",Ue,y(p.text),1)])]),_:1},8,["show"])}}}),Te=G(Re,[["__scopeId","data-v-fdcc294a"],["__file","/Users/wangkeai/work/xueyan/mai/flashmall-dapp/src/view/goods/components/EmptyTipsPop.vue"]]);const Ce={class:"w-full h-ful p-2.5"},Ee={class:"text-xl font-semibold mt-2.5"},Se={class:"bg-white rounded-xl overflow-hidden mt-2.5 p-2"},Be={class:"w-[50px] h-[50px] border border-dashed rounded-xl border-[#D9D9D9] text-center text-lg text-[#d9d9d9] font-bold"},Ge={class:"bg-white rounded-xl overflow-hidden mt-2.5"},Ne={class:"bg-white rounded-xl overflow-hidden mt-2.5"},qe={class:"bg-white rounded-xl overflow-hidden mt-2.5"},He={class:"bg-white rounded-xl overflow-hidden mt-2.5"},je=I("%"),ze={class:"bg-white rounded-xl overflow-hidden mt-2.5"},Ae={class:"bg-white rounded-xl overflow-hidden mt-2.5"},Fe={class:"bg-white rounded-xl overflow-hidden mt-2.5"},Me={class:"p-2 pt-0"},Oe={class:"w-[50px] h-[50px] border border-dashed rounded-xl border-gray2 bg-gray1 text-center text-lg text-gray2 font-bold"},Ke={class:"flex items-center justify-evenly mt-3"},Je=N({setup(p){const{t:i}=ie(),m=re(),x=pe();ce();const[d,b]=A(!1),[V,f]=A(!1),t=r({id:null,icons:"",goodsName:"",isHot:0,price:null,discountRatio:null,subclassId:null,goodsDesc:null,goodsPic:"",deliveryType:1,status:1}),c=r([]),g=r([]),D=r(0),Z=B(()=>[{value:0,text:i("common.no")},{value:1,text:i("common.yes")}]),_=r(1),ee=B(()=>[{value:1,text:i("common.send")},{value:2,text:i("common.offline")}]),$=r(0),oe=B(()=>{let o=C.value.filter(e=>e.type===_.value);return o=o.map(e=>({value:e.id,text:e.name})),o});F(_,(o,e)=>{let n=C.value.filter(U=>U.type===_.value);$.value=n.length&&n[0].id}),F(V,(o,e)=>{o&&setTimeout(()=>{f(!1)},3e3)});const te=async o=>{const e=await O(o,"goodsImg"),n=await J(e);if(!n.success)return c.value.length-=1;c.value[c.value.length-1]={url:K.imgUrl+n.data}},le=async o=>{const e=await O(o,"goodsDesc"),n=await J(e);if(!n.success)return g.value.length-=1;g.value[g.value.length-1]={url:K.imgUrl+n.data}},T=r(!1),L=r(!1),q=async()=>{T.value=!1,t.value.status=0,H(),j()},P=r(null),se=async()=>{if(!c.value.length)return P.value=i("goods.emptyImg"),f(!0);if(!t.value.goodsName||!t.value.price)return P.value=i("goods.notEmpty"),f(!0);if(!t.value.discountRatio||t.value.discountRatio<=0||+t.value.discountRatio>80)return P.value=i("shop.emptyRadio"),f(!0);L.value=!0,T.value=!1,t.value.status=1,H(),j()},H=()=>{const o=c.value.map(n=>n.url);console.log(o);const e=g.value.map(n=>n.url);t.value.icons=o.join(","),t.value.goodsPic=e.join(","),t.value.isHot=D.value,t.value.deliveryType=_.value,t.value.subclassId=$.value||null},j=async()=>{const o=await _e(t.value);L.value=!1,o.success&&x.back()},ae=()=>{T.value=!1},C=r([]),ne=async()=>{const o=await we();if(!o.success)return;C.value=o.data||[];const e=m.query.id||null;$.value=!e&&o.data&&o.data.length&&+o.data[0].id},de=async()=>{const o=m.query.id;if(!o)return;const e=await he(+o);!e.success||(t.value=e.data.goods,t.value.icons&&(c.value=(t.value.icons||"").split(",").map(n=>({url:n}))),t.value.goodsPic&&(g.value=t.value.goodsPic.split(",").map(n=>({url:n}))),D.value=t.value.isHot,_.value=t.value.deliveryType,$.value=t.value.subclassId||null)},ue=o=>o>80?80:o;return ve(()=>{ne(),de()}),(o,e)=>{const n=v("van-button"),U=v("van-uploader"),h=v("van-field"),E=v("van-dropdown-item"),S=v("van-dropdown-menu"),z=v("VanButton");return k(),me("div",Ce,[s("header",null,[l(ge),s("div",Ee,y(o.$t("goods.releaseGoods")),1)]),s("div",Se,[l(U,{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=a=>c.value=a),accept:"image/*","max-count":5,"preview-size":"50",afterRead:te},{default:u(()=>[s("div",Be,[l(n,{icon:"plus"})])]),_:1},8,["modelValue"])]),s("div",Ge,[l(h,{modelValue:t.value.goodsName,"onUpdate:modelValue":e[1]||(e[1]=a=>t.value.goodsName=a),rows:"3",autosize:"",type:"textarea",placeholder:`*${o.$t("goods.goodsName")}`,maxlength:"50","show-word-limit":""},null,8,["modelValue","placeholder"])]),s("div",Ne,[l(h,{"input-align":"right",autocomplete:"off",label:`*${o.$t("goods.isHot")}`},{input:u(()=>[l(S,{"active-color":"#FEA021"},{default:u(()=>[l(E,{modelValue:D.value,"onUpdate:modelValue":e[2]||(e[2]=a=>D.value=a),options:w(Z)},null,8,["modelValue","options"])]),_:1})]),_:1},8,["label"])]),s("div",qe,[l(h,{"input-align":"right",modelValue:t.value.price,"onUpdate:modelValue":e[3]||(e[3]=a=>t.value.price=a),label:`*${o.$t("goods.price")}`},null,8,["modelValue","label"])]),s("div",He,[l(h,{"input-align":"right",modelValue:t.value.discountRatio,"onUpdate:modelValue":e[4]||(e[4]=a=>t.value.discountRatio=a),type:"digit",label:`*${o.$t("goods.discountRatio")}`,placeholder:o.$t("shop.pleaseInputPoint"),formatter:ue},{"right-icon":u(()=>[je]),_:1},8,["modelValue","label","placeholder"])]),s("div",ze,[l(h,{"input-align":"right",autocomplete:"off",label:`*${o.$t("goods.deliveryType")}`},{input:u(()=>[l(S,{"active-color":"#FEA021"},{default:u(()=>[l(E,{modelValue:_.value,"onUpdate:modelValue":e[5]||(e[5]=a=>_.value=a),options:w(ee)},null,8,["modelValue","options"])]),_:1})]),_:1},8,["label"])]),s("div",Ae,[l(h,{"input-align":"right",autocomplete:"off",label:`*${o.$t("common.category")}`},{input:u(()=>[l(S,{"active-color":"#FEA021"},{default:u(()=>[l(E,{modelValue:$.value,"onUpdate:modelValue":e[6]||(e[6]=a=>$.value=a),options:w(oe)},null,8,["modelValue","options"])]),_:1})]),_:1},8,["label"])]),s("div",Fe,[l(h,{modelValue:t.value.goodsDesc,"onUpdate:modelValue":e[7]||(e[7]=a=>t.value.goodsDesc=a),rows:"3",autosize:"",type:"textarea",placeholder:`*${o.$t("goods.goodsDesc")}`},null,8,["modelValue","placeholder"]),s("div",Me,[l(U,{modelValue:g.value,"onUpdate:modelValue":e[8]||(e[8]=a=>g.value=a),accept:"image/*","max-count":3,"preview-size":"50",afterRead:le},{default:u(()=>[s("div",Oe,[l(n,{icon:"plus"})])]),_:1},8,["modelValue"])])]),s("div",Ke,[l(z,{type:"primary",class:"min-w-[130px] h-[40px] rounded-full border border-solid border-primary bg-none text-primary",onClick:e[9]||(e[9]=a=>q()),loading:L.value},{default:u(()=>[I(y(o.$t("goods.saveDraft")),1)]),_:1},8,["loading"]),l(z,{class:fe(["min-w-[130px] h-[40px] rounded-full bg-gray2 text-white",{"btn-orange":c.value.length>0&&t.value.goodsName&&t.value.price}]),onClick:e[10]||(e[10]=a=>se()),loading:L.value},{default:u(()=>[I(y(o.$t("goods.upimmediately")),1)]),_:1},8,["loading","class"])]),w(d)?(k(),R(ke,{key:0,onClose:e[11]||(e[11]=a=>w(b)(!1)),onHandleLeave:ae,onHandleDraft:q})):M("v-if",!0),w(V)?(k(),R(Te,{key:1,onClose:e[12]||(e[12]=a=>w(f)(!1)),text:P.value},null,8,["text"])):M("v-if",!0)])}}}),oo=G(Je,[["__scopeId","data-v-15e5717c"],["__file","/Users/wangkeai/work/xueyan/mai/flashmall-dapp/src/view/goods/EditGoods.vue"]]);export{oo as default};
