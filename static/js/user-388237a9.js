import{_ as F,d as T,O as ee,a as w,C as q,D as A,o as O,E as V,b as i,e as b,G as y,H as d,L as p,t as s,g as e,h as u,k,j as D,F as U,P as R,A as te,f as se,K as oe,M as j,Q as ne,T as ae,z,i as le,R as ie,p as re,l as ce,S as ue,U as de}from"./index-85d13ebb.js";import{P as E}from"./PopHeader-369b78ad.js";import{T as pe}from"./TokenBalance-9332a244.js";import{l as me,u as ve}from"./level-f468b31b.js";import{_ as fe}from"./close-384dfae6.js";import{Q as _e}from"./qrcode.vue.esm-a7335285.js";const G=""+new URL("../images/yes-97cb7030.svg",import.meta.url).href,H=""+new URL("../images/no-f92c763d.svg",import.meta.url).href;const he={class:"flex-center gap-4 text-white font-semibold"},ge={class:"mt-2 flex justify-center items-center opacity-50 text-xs"},we=T({props:{openFee:{type:Number,required:!0},buyMember:{type:Function,required:!0}},emits:["close","getIsVip"],setup(t,{emit:r}){const m=t,h=ee(),v=w(0),[f,a]=q(!1),x=A(()=>v.value>m.openFee),$=async()=>{const n=await(await h).allowance(R.flashMall);v.value=n.result},_=async()=>{a(!0),(await(await h).approve(R.flashMall)).success&&await $(),a(!1)},B=async()=>{a(!0);const n=await m.buyMember();a(!1),n.success&&r("getIsVip")},L=async()=>{await $()};return O(()=>{L()}),(n,C)=>{const g=V("VanButton");return i(),b(U,null,[y(E,{onClick:C[0]||(C[0]=c=>r("close"))},{default:d(()=>[p(s(n.$t("home.openVip")),1)]),_:1}),e("div",he,[u(x)?D("v-if",!0):(i(),k(g,{key:0,class:"btn-orange btn-shadow h-[35px] min-w-[120px] px-4",loading:u(f),onClick:_},{default:d(()=>[p(s(n.$t("assets.auth")),1)]),_:1},8,["loading"])),y(g,{class:"btn-orange btn-shadow h-[35px] min-w-[120px] px-4",loading:u(f),disabled:!u(x),onClick:B},{default:d(()=>[p(s(n.$t("home.toOpenVip",{fee:t.openFee})),1)]),_:1},8,["loading","disabled"])]),e("div",ge,[p(" MCOIN"+s(n.$t("assets.balance"))+" ",1),y(pe,{token:"MCOIN",tokenName:!1})])],64)}}}),be=F(we,[["__scopeId","data-v-874fe14a"],["__file","/Users/wangkeai/work/xueyan/mai/flashmall-dapp/src/view/home/components/BuyMemberPop.vue"]]);const ye={class:"w-[85vw] max-w-[375px] px-5 py-6 bg-popBg"},xe={class:"flex-start"},$e={class:"mx-1 font-bold"},ke={class:"flex-center-bw mt-5"},Ce={class:"text-gray3"},Ie={class:"font-bold text-primary"},Ve={class:"flex-center-bw mt-5"},Be={class:"text-gray3"},Le={class:"font-bold text-primary"},Pe={class:"mt-5 text-gray3"},Me={class:"font-bold text-primary"},Ue={class:"flex-center-bw mt-5"},Fe={class:"text-gray3"},Te={class:"font-bold text-primary"},Ae={key:0,src:G,class:"w-[14px]",alt:""},Se={key:1,src:H,class:"w-[14px]",alt:""},Ne={class:"flex-center-bw mt-5"},Re={class:"text-gray3"},qe={class:"font-bold text-primary"},Oe={key:0,src:G,class:"w-[14px]",alt:""},De={key:1,src:H,class:"w-[14px]",alt:""},je={class:"grid grid-cols-2 gap-2 mt-5"},ze=T({props:{show:{type:Boolean,required:!0},userInfo:{type:null,required:!0}},emits:["close","invite","handleTo"],setup(t,{emit:r}){const{show:m,userInfo:h}=t,{t:v}=te(),{members:f,memberPrice:a,buyMember:x,memberLevels:$}=se();A(()=>+c.value.one>(+h.contribute||0)||+c.value.two>(+h.totalContribute||0));const[_,B]=q(!1),L=w(!1),n=w(0),C=w(0),g=w([]),c=w({id:1,one:1e5,two:1e5}),P=w({address:"",agentAmount:.001,majorAmount:.002}),S=async()=>{L.value=await f()},K=async()=>{C.value=+await a()},J=async()=>{n.value=await $()},W=async()=>{const o=await me();!o.success||(g.value=o.data||[],X())},X=()=>{if(n.value<=0)return;const o=g.value.length,l=n.value||0;c.value=l===o+1?g.value[o-1]:g.value[l-1]},Y=async()=>{const o=await ve();!o.success||(P.value=o.data)},N=async()=>{if(!P.value.address)return;B(!0);const o=await ne(P.value.address,P.value.agentAmount.toString());B(!1),o.success&&(ae(v("home.upgradeTips")),setTimeout(()=>{r("close")},1500))};return O(async()=>{S(),K(),Y(),await J(),W()}),(o,l)=>{const M=V("VanButton"),Z=V("VanPopup");return i(),k(Z,{show:t.show,"onUpdate:show":l[4]||(l[4]=I=>j(m)?m.value=I:null),round:""},{default:d(()=>[e("div",ye,[L.value?(i(),b(U,{key:0},[y(E,{onClick:l[1]||(l[1]=I=>r("close"))},{default:d(()=>[e("div",xe,[e("span",null,s(o.$t("home.level")),1),e("span",$e,"V"+s(n.value||0),1),e("div",{class:"border border-solid border-primary text-xs text-primary px-[3px] py-[4px] rounded scale-90",onClick:l[0]||(l[0]=I=>r("handleTo","/levelPointsDetail"))},s(o.$t("home.levelDetail")),1)])]),_:1}),e("div",null,[e("div",ke,[e("div",Ce,s(o.$t("home.score")),1),e("div",Ie,s(t.userInfo.contribute||0),1)]),e("div",Ve,[e("div",Be,s(o.$t("home.deductScore")),1),e("div",Le,s(t.userInfo.totalContribute||0),1)]),e("div",Pe,[p(s(o.$t("home.nextLevel"))+" ",1),e("span",Me,"V"+s((n.value||0)+1),1)]),n.value>0?(i(),b(U,{key:0},[e("div",Ue,[e("div",Fe,s(o.$t("home.keepScore",{num:c.value.one||0})),1),e("div",Te,[(+t.userInfo.contribute||0)>=+c.value.one?(i(),b("img",Ae)):(i(),b("img",Se))])]),e("div",Ne,[e("div",Re,s(o.$t("home.deductScore",{num:c.value.two||0})),1),e("div",qe,[(+t.userInfo.totalContribute||0)>=+c.value.two?(i(),b("img",Oe)):(i(),b("img",De))])])],64)):D("v-if",!0)]),e("div",je,[y(M,{class:"btn text-primary font-bold h-9",round:"",onClick:l[2]||(l[2]=I=>r("invite"))},{default:d(()=>[p(s(o.$t("home.inviteRegister")),1)]),_:1}),n.value>0?(i(),k(M,{key:0,class:oe(["text-white font-bold h-9",+c.value.one>+t.userInfo.contribute||+c.value.two>+t.userInfo.totalContribute?"btn-disabled":"btn-orange"]),disabled:+c.value.one>+t.userInfo.contribute||+c.value.two>+t.userInfo.totalContribute,loading:u(_),onClick:N},{default:d(()=>[p(s(o.$t("home.upgrade")),1)]),_:1},8,["disabled","class","loading"])):(i(),k(M,{key:1,class:"text-white font-bold h-9 btn-orange",loading:u(_),onClick:N},{default:d(()=>[p(s(o.$t("home.upgrade")),1)]),_:1},8,["loading"]))])],64)):(i(),k(be,{key:1,openFee:C.value,buyMember:u(x),onClose:l[3]||(l[3]=I=>r("close")),onGetIsVip:S},null,8,["openFee","buyMember"]))])]),_:1},8,["show"])}}}),lt=F(ze,[["__scopeId","data-v-34e27dd2"],["__file","/Users/wangkeai/work/xueyan/mai/flashmall-dapp/src/view/home/components/LevelPop.vue"]]);const Q=t=>(re("data-v-7c16cd3e"),t=t(),ce(),t),Ee=Q(()=>e("img",{src:ue,class:"w-[100px] h-auto -mb-6 mx-auto"},null,-1)),Ge={class:"w-[85vw] max-w-[375px] px-5 py-6 bg-popBg rounded-[10px]"},He={class:"flex-center-bw pb-5"},Qe={class:"flex-start"},Ke=Q(()=>e("img",{src:fe,class:"w-[10px] h-[10px]",alt:""},null,-1)),Je=[Ke],We={class:"text-xs mt-5 text-center"},Xe={class:"text-default opacity-60"},Ye={class:"font-bold"},Ze=T({props:{show:{type:Boolean,required:!0}},emits:["close"],setup(t,{emit:r}){const{show:m}=t,{getCurrentAccount:h}=z(),v=A(()=>window.location.origin+"/#/home?invite="+h());return(f,a)=>{const x=V("VanButton"),$=V("VanPopup");return i(),k($,{show:t.show,"onUpdate:show":a[2]||(a[2]=_=>j(m)?m.value=_:null),style:{background:"transparent"}},{default:d(()=>[Ee,e("div",Ge,[e("div",He,[e("div",Qe,[e("span",null,s(f.$t("home.inviteRegister")),1)]),e("div",{onClick:a[0]||(a[0]=_=>r("close"))},Je)]),e("div",null,[y(_e,{value:u(v),size:200,level:"H",class:"mx-auto"},null,8,["value"]),e("div",We,[e("div",Xe,[e("span",Ye,s(f.$t("home.inviteLink")),1),e("span",null,s(u(le)(u(v),"...",15,4)),1)]),y(x,{class:"btn-orange w-[150px] h-10 text-white mt-5",onClick:a[1]||(a[1]=_=>u(ie)(u(v)))},{default:d(()=>[p(s(f.$t("common.copy")),1)]),_:1})])])])]),_:1},8,["show"])}}}),it=F(Ze,[["__scopeId","data-v-7c16cd3e"],["__file","/Users/wangkeai/work/xueyan/mai/flashmall-dapp/src/view/home/components/InviteCodePop.vue"]]),rt=t=>{const r=z().getCurrentAccount();return de("GET",`/v1/getUserInfo/${t||r}`,"")};export{it as I,lt as L,rt as u};
