(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8f5b5230"],{"2f72":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"otc-page"},[n("div",{staticClass:"otc-title"},[n("div",{staticClass:"left"},[t._v(t._s(t.$t("otc.title"))+"("+t._s(t.$t("otc.agent"))+")")]),n("div",{staticClass:"right",on:{click:function(e){return t.$gbUtils.handleToPage("/otcAgentHangOrder")}}},[n("span",[t._v(t._s(t.$t("otc.myOrder")))]),n("van-icon",{attrs:{name:"arrow"}})],1)]),n("div",{staticClass:"last-price"},[n("div",{staticClass:"price-box"},[n("span",[t._v(t._s(t.lastPrice))]),n("span",[t._v("MUSD/MAI")])]),n("div",{staticClass:"ptice-tips"},[t._v(t._s(t.$t("otc.lastPrice")))])]),n("OrderBox",{attrs:{type:2,lastPrice:t.lastPrice||0}}),n("OrderBox",{attrs:{type:1,lastPrice:t.lastPrice||0}})],1)},a=[],s=n("1da1"),i=(n("96cf"),n("3b74")),c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"order-box"},[n("div",{staticClass:"order-tilte"},[n("div",{staticClass:"left"},[t._v(t._s(1===t.type?t.$t("otc.buyOrder"):t.$t("otc.soldOrder")))]),n("van-button",{staticClass:"btn",on:{click:t.handleShowHang}},[t._v(t._s(1===t.type?t.$t("otc.hangBuy"):t.$t("otc.hangSale")))])],1),n("div",{staticClass:"order-list"},[n("div",{staticClass:"list-tab"},[n("div",{staticClass:"tab"},[t._v(t._s(t.$t("otc.price"))+"(MU)")]),n("div",{staticClass:"tab"},[t._v(t._s(t.$t("otc.total"))+"(MAI)")])]),n("div",{staticClass:"list-box"},[t._l(t.priceList,(function(e,r){return n("OrderPiceTotal",{key:r,ref:"OrderPiceTotal",refInFor:!0,attrs:{price:e,type:t.type}})})),t.priceList.length?t._e():n("van-empty")],2)]),1===t.type&&t.hangPopShow?n("HangBuy",{attrs:{lastPrice:t.lastPrice},on:{close:t.handleShowHang}}):t._e(),2===t.type&&t.hangPopShow?n("HangSale",{attrs:{lastPrice:t.lastPrice},on:{close:t.handleShowHang}}):t._e()],1)},o=[],u=(n("d81d"),n("4e82"),function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("VanPopup",{staticClass:"otc-pop",staticStyle:{background:"transparent",width:"80%","max-width":"375px","min-width":"300px"},on:{"click-overlay":t.handleClose},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[r("div",{staticClass:"pop-body"},[r("div",{staticClass:"pop-title"},[t._v(t._s(t.$t("otc.hangBuy")))]),r("van-field",{staticClass:"pop-input",attrs:{"input-align":"right",type:"number",formatter:t.formatterNum,label:t.$t("otc.price"),placeholder:t.$t("otc.nowPrice",{price:t.lastPrice})},model:{value:t.price,callback:function(e){t.price=e},expression:"price"}}),r("van-field",{staticClass:"pop-input",attrs:{"input-align":"right",type:"number",label:t.$t("otc.hangAmount"),placeholder:t.$t("otc.pleaseInput")},scopedSlots:t._u([{key:"button",fn:function(){return[r("van-button",{staticClass:"max-btn",attrs:{size:"small",color:"#5E12E7",disabled:!t.price},on:{click:t.handleMax}},[t._v("Max")])]},proxy:!0}]),model:{value:t.amount,callback:function(e){t.amount=e},expression:"amount"}}),r("div",{staticClass:"pop-balance"},[t._v("MUSD: "+t._s(t.$gbUtils.formatBalance(t.balance)))]),r("div",{staticClass:"pop-tips"},[t._v(t._s(t.$t("otc.hangBuyTip",{num:t.minAmount})))]),r("div",{staticClass:"pop-tips"},[t._v(t._s(t.$t("otc.estimatedConsumption",{num:t.needAll})))]),t.auth?r("van-button",{staticClass:"pop-btn",attrs:{loading:t.hangLoading,disabled:t.price<=0||+t.amount<+t.minAmount||t.needAll>+t.balance},on:{click:t.handlePending}},[t._v(t._s(t.$t("otc.submitHang")))]):r("van-button",{staticClass:"pop-btn",attrs:{loading:t.approveLoading},on:{click:t.approve}},[t._v(t._s(t.$t("otc.approve")))])],1),r("div",{staticClass:"close-icon",on:{click:t.handleClose}},[r("img",{attrs:{src:n("cd5c")}})])])}),l=[],p=(n("ac1f"),n("5319"),n("1f5d")),d=n("f645"),h={name:"",props:["lastPrice"],data:function(){return{show:!0,type:1,price:"",amount:"",tokenAddress:"",hangLoading:!1,balance:0,minAmount:0,auth:!0,approveLoading:!0}},computed:{needAll:function(){return this.price*this.amount||0}},methods:{formatterNum:function(t){return t.replace(/[^0-9.]/g,"").replace(/^(-)*(\d+)\.(\d\d).*$/,"$1$2.$3")},handleClose:function(){this.$emit("close")},init:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.getMinAmount(),e.next=3,t.gettokenAddress();case 3:t.getBalance();case 4:case"end":return e.stop()}}),e)})))()},getMinAmount:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["a"].MIN_AMOUNT();case 2:if(n=e.sent,n.success){e.next=5;break}return e.abrupt("return");case 5:t.minAmount=n.result||0;case 6:case"end":return e.stop()}}),e)})))()},gettokenAddress:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["a"].MUSD();case 2:if(n=e.sent,n.success){e.next=5;break}return e.abrupt("return");case 5:t.tokenAddress=n.result;case 6:case"end":return e.stop()}}),e)})))()},getBalance:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.tokenAddress){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.$web3.balanceOf(t.tokenAddress,d["a"].otcAgent);case 4:if(n=e.sent,n.success){e.next=7;break}return e.abrupt("return");case 7:t.balance=n.result||0;case 8:case"end":return e.stop()}}),e)})))()},handleMax:function(){this.amount=this.balance/this.price},getAllowance:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.approveLoading=!0,e.next=3,p["a"].allowance(t.tokenAddress,d["a"].otcAgent);case 3:if(n=e.sent,t.approveLoading=!1,n.success){e.next=7;break}return e.abrupt("return");case 7:t.auth=n.result>0;case 8:case"end":return e.stop()}}),e)})))()},approve:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.approveLoading=!0,e.next=3,p["a"].approve(t.tokenAddress,d["a"].otcAgent);case 3:if(n=e.sent,t.approveLoading=!1,n.success){e.next=7;break}return e.abrupt("return",t.$toast("fail"));case 7:t.$toast("Success"),t.auth=!0;case 9:case"end":return e.stop()}}),e)})))()},handlePending:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.hangLoading=!0,e.next=3,i["a"].pending(t.type,t.price,t.amount);case 3:if(n=e.sent,t.hangLoading=!1,n.success){e.next=7;break}return e.abrupt("return");case 7:t.$emit("close"),t.$parent.init();case 9:case"end":return e.stop()}}),e)})))()}},mounted:function(){this.init()}},m=h,f=n("2877"),v=Object(f["a"])(m,u,l,!1,null,"3f2b064a",null),b=v.exports,g=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("VanPopup",{staticClass:"otc-pop",staticStyle:{background:"transparent",width:"80%","max-width":"375px","min-width":"300px"},on:{"click-overlay":t.handleClose},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[r("div",{staticClass:"pop-body"},[r("div",{staticClass:"pop-title"},[t._v(t._s(t.$t("otc.hangSale")))]),r("van-field",{staticClass:"pop-input",attrs:{"input-align":"right",type:"number",formatter:t.formatterNum,label:t.$t("otc.price"),placeholder:t.$t("otc.nowPrice",{price:t.lastPrice})},model:{value:t.price,callback:function(e){t.price=e},expression:"price"}}),r("van-field",{staticClass:"pop-input",attrs:{"input-align":"right",type:"number",label:t.$t("otc.hangAmount"),placeholder:t.$t("otc.pleaseInput")},scopedSlots:t._u([{key:"button",fn:function(){return[r("van-button",{staticClass:"max-btn",attrs:{size:"small",color:"#5E12E7",disabled:!t.price},on:{click:t.handleMax}},[t._v("Max")])]},proxy:!0}]),model:{value:t.amount,callback:function(e){t.amount=e},expression:"amount"}}),r("div",{staticClass:"pop-balance"},[t._v("MAI: "+t._s(t.$gbUtils.formatBalance(t.balance)))]),r("div",{staticClass:"pop-tips"},[t._v(t._s(t.$t("otc.hangBuyTip",{num:t.minAmount})))]),r("div",{staticClass:"pop-tips"},[t._v(" "+t._s(t.$t("otc.expectedToObtain",{num:t.needAll})))]),t.auth?r("van-button",{staticClass:"pop-btn",attrs:{loading:t.hangLoading,disabled:t.price<=0||t.amount<+t.minAmount||t.amount>+t.balance},on:{click:t.handlePending}},[t._v(t._s(t.$t("otc.submitHang")))]):r("van-button",{staticClass:"pop-btn",attrs:{loading:t.approveLoading},on:{click:t.approve}},[t._v(t._s(t.$t("otc.approve")))])],1),r("div",{staticClass:"close-icon",on:{click:t.handleClose}},[r("img",{attrs:{src:n("cd5c")}})])])},x=[],w={name:"",props:["lastPrice"],data:function(){return{show:!0,type:2,price:"",amount:"",tokenAddress:"",hangLoading:!1,balance:0,minAmount:0,auth:!0,approveLoading:!0}},computed:{needAll:function(){return this.price*this.amount||0}},methods:{formatterNum:function(t){return t.replace(/[^0-9.]/g,"").replace(/^(-)*(\d+)\.(\d\d).*$/,"$1$2.$3")},handleClose:function(){this.$emit("close")},init:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.getMinAmount(),e.next=3,t.gettokenAddress();case 3:t.getBalance();case 4:case"end":return e.stop()}}),e)})))()},getMinAmount:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["a"].MIN_AMOUNT();case 2:if(n=e.sent,n.success){e.next=5;break}return e.abrupt("return");case 5:t.minAmount=n.result||0;case 6:case"end":return e.stop()}}),e)})))()},gettokenAddress:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["a"].MAI();case 2:if(n=e.sent,n.success){e.next=5;break}return e.abrupt("return");case 5:t.tokenAddress=n.result;case 6:case"end":return e.stop()}}),e)})))()},getBalance:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.tokenAddress){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.$web3.balanceOf(t.tokenAddress,d["a"].otcAgent);case 4:if(n=e.sent,n.success){e.next=7;break}return e.abrupt("return");case 7:t.balance=n.result||0;case 8:case"end":return e.stop()}}),e)})))()},handleMax:function(){this.amount=this.balance},getAllowance:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.approveLoading=!0,e.next=3,p["a"].allowance(t.tokenAddress,d["a"].otcAgent);case 3:if(n=e.sent,t.approveLoading=!1,n.success){e.next=7;break}return e.abrupt("return");case 7:t.auth=n.result>0;case 8:case"end":return e.stop()}}),e)})))()},approve:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.approveLoading=!0,e.next=3,p["a"].approve(t.tokenAddress,d["a"].otcAgent);case 3:if(n=e.sent,t.approveLoading=!1,n.success){e.next=7;break}return e.abrupt("return",t.$toast("fail"));case 7:t.$toast("Success"),t.auth=!0;case 9:case"end":return e.stop()}}),e)})))()},handlePending:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.hangLoading=!0,e.next=3,i["a"].pending(t.type,t.price,t.amount);case 3:if(n=e.sent,t.hangLoading=!1,n.success){e.next=7;break}return e.abrupt("return");case 7:t.$emit("close"),t.$parent.init();case 9:case"end":return e.stop()}}),e)})))()}},mounted:function(){this.init()}},k=w,_=Object(f["a"])(k,g,x,!1,null,"b399c4a0",null),$=_.exports,y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"total-box"},[n("div",{staticClass:"order-item"},[t._v(t._s(t.price))]),n("div",{staticClass:"order-item"},[t._v(t._s(t.$gbUtils.formatBalance(t.totalAmount)))]),n("div",{staticClass:"order-item"},[n("van-button",{staticClass:"check-item",on:{click:t.handleCheck}},[t._v(t._s(1===t.type?t.$t("otc.sell"):t.$t("otc.purchase")))])],1),t.priceListShow?n("OrderPriceList",{attrs:{price:t.price,type:t.type},on:{close:t.handleCheck,handleTrade:t.handleTrade}}):t._e(),t.tradeShow?n("TradePop",{attrs:{id:t.curId,type:t.curType,orderInfo:t.curInfo},on:{close:function(){t.tradeShow=!1}}}):t._e()],1)},A=[],C=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("VanPopup",{staticClass:"otc-pop",staticStyle:{background:"transparent",width:"80%","max-width":"375px","min-width":"300px"},on:{"click-overlay":t.close},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[r("div",{staticClass:"pop-body"},[r("div",{staticClass:"pop-title"},[t._v(t._s(t.price)+" "+t._s(1===t.type?t.$t("otc.buy"):t.$t("otc.sale")))]),r("van-checkbox-group",{model:{value:t.batchId,callback:function(e){t.batchId=e},expression:"batchId"}},t._l(t.idList,(function(e,n){return r("van-checkbox",{key:e,staticClass:"check-box",attrs:{"checked-color":"#6667FF",name:e}},[r("OrderPriceInfo",{attrs:{index:n,id:e,price:t.price,type:t.type},on:{handleTrade:t.handleTrade,handleHideItem:t.handleHideItem}})],1)})),1),t.auth?r("van-button",{staticClass:"pop-btn",attrs:{disabled:!t.batchId.length,loading:t.batchLoading},on:{click:t.handleBatchTrade}},[t._v(t._s(1===t.type?t.$t("otc.batchSell"):t.$t("otc.batchBuy")))]):r("van-button",{staticClass:"pop-btn",attrs:{loading:t.approveLoading},on:{click:t.approve}},[t._v(t._s(t.$t("otc.approve")))])],1),r("div",{staticClass:"close-icon",on:{click:t.close}},[r("img",{attrs:{src:n("cd5c")}})])])},I=[],O=(n("a434"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"flex-box"},[n("div",{staticClass:"amount"},[t._v(t._s(t.$gbUtils.formatBalance(t.orderInfo.remain||0))+" MAI")]),n("VanButton",{staticClass:"pop-btn",on:{click:t.handleTrade}},[t._v(t._s(2===t.type?t.$t("otc.purchase"):t.$t("otc.sell")))])],1)}),R=[],L={name:"",props:["id","price","type","index"],data:function(){return{orderInfo:{}}},methods:{getOrderInfo:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["a"].getOrderInfo(t.id);case 2:if(n=e.sent,n.success){e.next=5;break}return e.abrupt("return");case 5:t.orderInfo={direct:n.result.direct,price:t.$web3.fromWei(n.result.price),total:t.$web3.fromWei(n.result.total),remain:t.$web3.fromWei(n.result.remain),token:n.result.token,sender:n.result.sender,status:n.result.status},t.orderInfo.remain<=0&&t.$emit("handleHideItem",t.index);case 7:case"end":return e.stop()}}),e)})))()},handleTrade:function(){this.$emit("handleTrade",this.type,this.id,this.orderInfo)}},mounted:function(){this.getOrderInfo()}},P=L,T=(n("c069"),Object(f["a"])(P,O,R,!1,null,"6d9f0360",null)),S=T.exports,M={name:"",props:["price","type"],components:{OrderPriceInfo:S},data:function(){return{show:!0,idList:[],batchId:[],batchLoading:!1,tokenAddress:"",auth:!0,approveLoading:!0}},methods:{close:function(){this.$emit("close")},init:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.getIdList(),e.next=3,t.gettokenAddress();case 3:case"end":return e.stop()}}),e)})))()},handleHideItem:function(t){this.idList.splice(t,1)},getIdList:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["a"].getMarketIds(t.type,t.price);case 2:if(n=e.sent,n.success){e.next=5;break}return e.abrupt("return");case 5:t.idList=(n.result||[]).map((function(t){return t}));case 6:case"end":return e.stop()}}),e)})))()},gettokenAddress:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(2!==t.type){e.next=6;break}return e.next=3,i["a"].MUSD();case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,i["a"].MAI();case 8:e.t0=e.sent;case 9:if(n=e.t0,n.success){e.next=12;break}return e.abrupt("return");case 12:t.tokenAddress=n.result;case 13:case"end":return e.stop()}}),e)})))()},getAllowance:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.approveLoading=!0,e.next=3,p["a"].allowance(t.tokenAddress,d["a"].otc);case 3:if(n=e.sent,t.approveLoading=!1,n.success){e.next=7;break}return e.abrupt("return");case 7:t.auth=n.result>0;case 8:case"end":return e.stop()}}),e)})))()},approve:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.approveLoading=!0,e.next=3,p["a"].approve(t.tokenAddress,d["a"].otc);case 3:if(n=e.sent,t.approveLoading=!1,n.success){e.next=7;break}return e.abrupt("return",t.$toast("fail"));case 7:t.$toast("Success"),t.auth=!0;case 9:case"end":return e.stop()}}),e)})))()},handleBatchTrade:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.batchLoading=!0,e.next=3,i["a"].batchTrade(t.batchId);case 3:if(n=e.sent,t.batchLoading=!1,n.success){e.next=7;break}return e.abrupt("return");case 7:t.$emit("close"),t.$parent.init(),t.$parent.$parent.init();case 10:case"end":return e.stop()}}),e)})))()},handleTrade:function(t,e,n){this.close(),this.$emit("handleTrade",t,e,n)}},mounted:function(){this.init()}},j=M,B=(n("acb6"),Object(f["a"])(j,C,I,!1,null,"3d0d16c4",null)),N=B.exports,U=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("VanPopup",{staticClass:"otc-pop",staticStyle:{background:"transparent",width:"80%","max-width":"375px","min-width":"300px"},on:{"click-overlay":t.close},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[r("div",{staticClass:"pop-body"},[r("div",{staticClass:"pop-title"},[t._v(t._s(2===t.type?t.$t("otc.purchase"):t.$t("otc.sell")))]),r("van-field",{staticClass:"pop-input",attrs:{disabled:"","input-align":"right",type:"number",label:t.$t("otc.price")},scopedSlots:t._u([{key:"button",fn:function(){return[t._v("MUSD")]},proxy:!0}]),model:{value:t.orderInfo.price,callback:function(e){t.$set(t.orderInfo,"price",e)},expression:"orderInfo.price"}}),r("van-field",{staticClass:"pop-input",attrs:{disabled:"","input-align":"right",type:"number",label:t.$t("otc.total")},scopedSlots:t._u([{key:"button",fn:function(){return[t._v("MAI")]},proxy:!0}]),model:{value:t.orderInfo.remain,callback:function(e){t.$set(t.orderInfo,"remain",e)},expression:"orderInfo.remain"}}),r("van-field",{staticClass:"pop-input",attrs:{"input-align":"right",type:"number",label:2===t.type?t.$t("otc.buyNum"):t.$t("otc.sellNum"),placeholder:t.$t("otc.pleaseInput")},scopedSlots:t._u([{key:"button",fn:function(){return[r("van-button",{staticClass:"max-btn",attrs:{size:"small",color:"#5E12E7"},on:{click:t.handleMax}},[t._v("Max")])]},proxy:!0}]),model:{value:t.amount,callback:function(e){t.amount=e},expression:"amount"}}),r("div",{staticClass:"pop-balance"},[t._v(t._s(1===t.type?"MAI":"MUSD")+": "+t._s(t.$gbUtils.formatBalance(t.balance)))]),r("div",{staticClass:"pop-tips"},[t._v(" "+t._s(t.$t("otc.tradeTips",{num1:t.canTradeNum,num2:t.orderInfo.remain}))+"("+t._s(t.$t("otc.remainingTip",{num:t.minAmount}))+")")]),r("div",{staticClass:"pop-tips"},[1===t.type?r("span",[t._v(t._s(t.$t("otc.expectedToObtain",{num:t.needAll})))]):t._e(),2===t.type?r("span",[t._v(" "+t._s(t.$t("otc.estimatedConsumption",{num:t.needAll})))]):t._e()]),t.auth?r("van-button",{staticClass:"pop-btn",attrs:{disabled:t.amount<=0||t.amount>t.canTradeNum&&t.amount!=+t.orderInfo.remain||t.amount>+t.orderInfo.remain,loading:t.tradeLoading},on:{click:t.handleTrade}},[t._v(t._s(1===t.type?t.$t("otc.sell"):t.$t("otc.purchase")))]):r("van-button",{staticClass:"pop-btn",attrs:{loading:t.approveLoading},on:{click:t.approve}},[t._v(t._s(t.$t("otc.approve")))])],1),r("div",{staticClass:"close-icon",on:{click:t.close}},[r("img",{attrs:{src:n("cd5c")}})])])},E=[],H={name:"",props:["id","type","orderInfo"],data:function(){return{show:!0,amount:null,tokenAddress:"",hangLoading:!1,balance:0,minAmount:0,auth:!0,approveLoading:!0,tradeLoading:!1}},computed:{needAll:function(){return this.orderInfo.price*this.amount||0},canTradeNum:function(){return+this.orderInfo.remain-this.minAmount}},methods:{close:function(){this.$emit("close")},handleMax:function(){if(2===this.type){var t=this.orderInfo.price*this.orderInfo.remain,e=this.balance/this.orderInfo.price;this.amount=this.balance>=t?this.orderInfo.remain:e>=this.canTradeNum?this.canTradeNum:e}else this.amount=this.balance>=this.orderInfo.remain?this.orderInfo.remain:this.balance>=this.canTradeNum?this.canTradeNum:this.balance},init:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.getMinAmount(),e.next=3,t.gettokenAddress();case 3:t.getBalance();case 4:case"end":return e.stop()}}),e)})))()},getMinAmount:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["a"].MIN_REMAIN_AMOUNT();case 2:if(n=e.sent,n.success){e.next=5;break}return e.abrupt("return");case 5:t.minAmount=n.result||0;case 6:case"end":return e.stop()}}),e)})))()},gettokenAddress:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(2!==t.type){e.next=6;break}return e.next=3,i["a"].MUSD();case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,i["a"].MAI();case 8:e.t0=e.sent;case 9:if(n=e.t0,n.success){e.next=12;break}return e.abrupt("return");case 12:t.tokenAddress=n.result;case 13:case"end":return e.stop()}}),e)})))()},getBalance:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.tokenAddress){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.$web3.balanceOf(t.tokenAddress,d["a"].otcAgent);case 4:if(n=e.sent,n.success){e.next=7;break}return e.abrupt("return");case 7:t.balance=n.result||0;case 8:case"end":return e.stop()}}),e)})))()},getAllowance:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.approveLoading=!0,e.next=3,p["a"].allowance(t.tokenAddress,d["a"].otc);case 3:if(n=e.sent,t.approveLoading=!1,n.success){e.next=7;break}return e.abrupt("return");case 7:t.auth=n.result>0;case 8:case"end":return e.stop()}}),e)})))()},approve:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.approveLoading=!0,e.next=3,p["a"].approve(t.tokenAddress,d["a"].otc);case 3:if(n=e.sent,t.approveLoading=!1,n.success){e.next=7;break}return e.abrupt("return",t.$toast("fail"));case 7:t.$toast("Success"),t.auth=!0;case 9:case"end":return e.stop()}}),e)})))()},handleTrade:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.tradeLoading=!0,e.next=3,i["a"].trade(t.id,t.amount);case 3:if(n=e.sent,t.tradeLoading=!1,n.success){e.next=7;break}return e.abrupt("return");case 7:t.$emit("close"),t.$parent.init(),t.$parent.$parent.init();case 10:case"end":return e.stop()}}),e)})))()}},mounted:function(){this.init()}},D=H,z=Object(f["a"])(D,U,E,!1,null,"60f89fb2",null),V=z.exports,W={name:"",props:["price","type"],components:{OrderPriceList:N,TradePop:V},data:function(){return{totalAmount:0,priceListShow:!1,tradeShow:!1,curId:"",curType:"",curInfo:"",timer:null}},watch:{price:function(t){this.init()}},methods:{init:function(){this.getPriceTotals()},getPriceTotals:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["a"].getPriceTotals(t.type,t.price);case 2:if(n=e.sent,n.success){e.next=5;break}return e.abrupt("return");case 5:t.totalAmount=n.result||0;case 6:case"end":return e.stop()}}),e)})))()},handleCheck:function(){this.priceListShow=!this.priceListShow},handleTrade:function(t,e,n){this.curType=t,this.curId=e,this.curInfo=n,this.tradeShow=!0},initTimer:function(){var t=this;this.timer=setInterval((function(){t.init()}),15e3)}},mounted:function(){this.init(),this.initTimer()},beforeDestroy:function(){clearInterval(this.timer),this.timer=null}},F=W,J=(n("c2d6"),Object(f["a"])(F,y,A,!1,null,"3430a966",null)),q=J.exports,G={name:"",components:{HangBuy:b,HangSale:$,OrderPiceTotal:q},props:["type","lastPrice"],data:function(){return{hangPopShow:!1,priceList:[],offset:0,size:10,num:1,timer:null}},methods:{handleShowHang:function(){this.hangPopShow=!this.hangPopShow},getList:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["a"].getMarketPrices(t.type,t.offset,t.size);case 2:if(n=e.sent,n.success){e.next=5;break}return e.abrupt("return");case 5:r=(n.result||[]).map((function(e){return t.$web3.fromWei(e)})),1===t.type?r.sort((function(t,e){return e-t})):r.sort((function(t,e){return t-e})),t.priceList=r;case 8:case"end":return e.stop()}}),e)})))()},init:function(){this.getList()},initTimer:function(){var t=this;this.timer=setInterval((function(){t.init()}),15e3)}},mounted:function(){this.init(),this.initTimer()},beforeDestroy:function(){clearInterval(this.timer),this.timer=null}},K=G,Q=(n("9ca6"),Object(f["a"])(K,c,o,!1,null,"2fad264c",null)),X=Q.exports,Y={name:"",components:{OrderBox:X},data:function(){return{lastPrice:0,type:2}},methods:{getLastPrice:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["a"].lastPrice();case 2:if(n=e.sent,n.success){e.next=5;break}return e.abrupt("return");case 5:t.lastPrice=n.result;case 6:case"end":return e.stop()}}),e)})))()},init:function(){this.getLastPrice()}},mounted:function(){this.init()}},Z=Y,tt=(n("91da"),Object(f["a"])(Z,r,a,!1,null,"5e5962af",null));e["default"]=tt.exports},"30fc":function(t,e,n){},"43bd":function(t,e,n){},"91da":function(t,e,n){"use strict";n("b9b3")},"9ca6":function(t,e,n){"use strict";n("30fc")},acb6:function(t,e,n){"use strict";n("e894")},b9b3:function(t,e,n){},c069:function(t,e,n){"use strict";n("43bd")},c2d6:function(t,e,n){"use strict";n("e2be")},e2be:function(t,e,n){},e894:function(t,e,n){}}]);
//# sourceMappingURL=chunk-8f5b5230.54836802.js.map