(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3c97ad09"],{"06a4":function(e,t,n){},"0f9d":function(e,t,n){},"21e3":function(e,t,n){"use strict";n("edc3")},2248:function(e,t,n){},5387:function(e,t,n){"use strict";n("0f9d")},"5c51":function(e,t,n){"use strict";n("06a4")},8346:function(e,t,n){"use strict";n("c78d")},c78d:function(e,t,n){},e65d:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"otc-page"},[n("div",{staticClass:"otc-title"},[n("div",{staticClass:"left"},[e._v(e._s(e.$t("otc.title")))]),n("div",{staticClass:"right",on:{click:function(t){return e.$gbUtils.handleToPage("/myHangOrder")}}},[n("span",[e._v(e._s(e.$t("otc.myOrder")))]),n("van-icon",{attrs:{name:"arrow"}})],1)]),n("div",{staticClass:"last-price"},[n("div",{staticClass:"price-box"},[n("span",[e._v(e._s(e.lastPrice))]),n("span",[e._v("MUSD/MAI")])]),n("div",{staticClass:"ptice-tips"},[e._v(e._s(e.$t("otc.lastPrice")))])]),n("OrderBox",{attrs:{type:2,lastPrice:e.lastPrice||0}}),n("OrderBox",{attrs:{type:1,lastPrice:e.lastPrice||0}})],1)},a=[],s=n("1da1"),i=(n("96cf"),n("6312")),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"order-box"},[n("div",{staticClass:"order-tilte"},[n("div",{staticClass:"left"},[e._v(e._s(1===e.type?e.$t("otc.buyOrder"):e.$t("otc.soldOrder")))]),n("van-button",{staticClass:"btn",on:{click:e.handleShowHang}},[e._v(e._s(1===e.type?e.$t("otc.hangBuy"):e.$t("otc.hangSale")))])],1),n("div",{staticClass:"order-list"},[n("div",{staticClass:"list-tab"},[n("div",{staticClass:"tab"},[e._v(e._s(e.$t("otc.price"))+"(MU)")]),n("div",{staticClass:"tab"},[e._v(e._s(e.$t("otc.total"))+"(MAI)")])]),n("div",{staticClass:"list-box"},[e._l(e.priceList,(function(t,r){return n("OrderPiceTotal",{key:r,ref:"OrderPiceTotal",refInFor:!0,attrs:{price:t,type:e.type}})})),e.priceList.length?e._e():n("van-empty")],2)]),1===e.type&&e.hangPopShow?n("HangBuy",{attrs:{lastPrice:e.lastPrice},on:{close:e.handleShowHang}}):e._e(),2===e.type&&e.hangPopShow?n("HangSale",{attrs:{lastPrice:e.lastPrice},on:{close:e.handleShowHang}}):e._e()],1)},o=[],u=(n("d81d"),n("4e82"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("VanPopup",{staticClass:"otc-pop",staticStyle:{background:"transparent",width:"80%","max-width":"375px","min-width":"300px"},on:{"click-overlay":e.handleClose},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[r("div",{staticClass:"pop-body"},[r("div",{staticClass:"pop-title"},[e._v(e._s(e.$t("otc.hangBuy")))]),r("van-field",{staticClass:"pop-input",attrs:{"input-align":"right",type:"number",formatter:e.formatterNum,label:e.$t("otc.price"),placeholder:e.$t("otc.nowPrice",{price:e.lastPrice})},model:{value:e.price,callback:function(t){e.price=t},expression:"price"}}),r("van-field",{staticClass:"pop-input",attrs:{"input-align":"right",type:"number",label:e.$t("otc.hangAmount"),placeholder:e.$t("otc.pleaseInput")},scopedSlots:e._u([{key:"button",fn:function(){return[r("van-button",{staticClass:"max-btn",attrs:{size:"small",color:"#5E12E7",disabled:!e.price},on:{click:e.handleMax}},[e._v("Max")])]},proxy:!0}]),model:{value:e.amount,callback:function(t){e.amount=t},expression:"amount"}}),r("div",{staticClass:"pop-balance"},[e._v("MUSD: "+e._s(e.$gbUtils.formatBalance(e.balance)))]),r("div",{staticClass:"pop-tips"},[e._v(e._s(e.$t("otc.hangBuyTip",{num:e.minAmount})))]),r("div",{staticClass:"pop-tips"},[e._v(e._s(e.$t("otc.estimatedConsumption",{num:e.needAll})))]),e.auth?r("van-button",{staticClass:"pop-btn",attrs:{loading:e.hangLoading,disabled:e.price<=0||+e.amount<+e.minAmount||e.needAll>+e.balance},on:{click:e.handlePending}},[e._v(e._s(e.$t("otc.submitHang")))]):r("van-button",{staticClass:"pop-btn",attrs:{loading:e.approveLoading},on:{click:e.approve}},[e._v(e._s(e.$t("otc.approve")))])],1),r("div",{staticClass:"close-icon",on:{click:e.handleClose}},[r("img",{attrs:{src:n("cd5c")}})])])}),l=[],p=(n("ac1f"),n("5319"),n("1f5d")),d=n("f645"),h={name:"",props:["lastPrice"],data:function(){return{show:!0,type:1,price:"",amount:"",tokenAddress:"",hangLoading:!1,balance:0,minAmount:0,auth:!1,approveLoading:!0}},computed:{needAll:function(){return this.price*this.amount||0}},methods:{formatterNum:function(e){return e.replace(/[^0-9.]/g,"").replace(/^(-)*(\d+)\.(\d\d).*$/,"$1$2.$3")},handleClose:function(){this.$emit("close")},init:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.getMinAmount(),t.next=3,e.gettokenAddress();case 3:e.getBalance(),e.getAllowance();case 5:case"end":return t.stop()}}),t)})))()},getMinAmount:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i["a"].MIN_AMOUNT();case 2:if(n=t.sent,n.success){t.next=5;break}return t.abrupt("return");case 5:e.minAmount=n.result||0;case 6:case"end":return t.stop()}}),t)})))()},gettokenAddress:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i["a"].MUSD();case 2:if(n=t.sent,n.success){t.next=5;break}return t.abrupt("return");case 5:e.tokenAddress=n.result;case 6:case"end":return t.stop()}}),t)})))()},getBalance:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.tokenAddress){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.$web3.balanceOf(e.tokenAddress);case 4:if(n=t.sent,n.success){t.next=7;break}return t.abrupt("return");case 7:e.balance=n.result||0;case 8:case"end":return t.stop()}}),t)})))()},handleMax:function(){this.amount=this.balance/this.price},getAllowance:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.approveLoading=!0,t.next=3,p["a"].allowance(e.tokenAddress,d["a"].otc);case 3:if(n=t.sent,e.approveLoading=!1,n.success){t.next=7;break}return t.abrupt("return");case 7:e.auth=n.result>0;case 8:case"end":return t.stop()}}),t)})))()},approve:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.approveLoading=!0,t.next=3,p["a"].approve(e.tokenAddress,d["a"].otc);case 3:if(n=t.sent,e.approveLoading=!1,n.success){t.next=7;break}return t.abrupt("return",e.$toast("fail"));case 7:e.$toast("Success"),e.auth=!0;case 9:case"end":return t.stop()}}),t)})))()},handlePending:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.hangLoading=!0,t.next=3,i["a"].pending(e.type,e.price,e.amount);case 3:if(n=t.sent,e.hangLoading=!1,n.success){t.next=7;break}return t.abrupt("return");case 7:e.$emit("close"),e.$parent.init();case 9:case"end":return t.stop()}}),t)})))()}},mounted:function(){this.init()}},m=h,f=n("2877"),v=Object(f["a"])(m,u,l,!1,null,"557bbae0",null),b=v.exports,g=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("VanPopup",{staticClass:"otc-pop",staticStyle:{background:"transparent",width:"80%","max-width":"375px","min-width":"300px"},on:{"click-overlay":e.handleClose},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[r("div",{staticClass:"pop-body"},[r("div",{staticClass:"pop-title"},[e._v(e._s(e.$t("otc.hangSale")))]),r("van-field",{staticClass:"pop-input",attrs:{"input-align":"right",type:"number",formatter:e.formatterNum,label:e.$t("otc.price"),placeholder:e.$t("otc.nowPrice",{price:e.lastPrice})},model:{value:e.price,callback:function(t){e.price=t},expression:"price"}}),r("van-field",{staticClass:"pop-input",attrs:{"input-align":"right",type:"number",label:e.$t("otc.hangAmount"),placeholder:e.$t("otc.pleaseInput")},scopedSlots:e._u([{key:"button",fn:function(){return[r("van-button",{staticClass:"max-btn",attrs:{size:"small",color:"#5E12E7",disabled:!e.price},on:{click:e.handleMax}},[e._v("Max")])]},proxy:!0}]),model:{value:e.amount,callback:function(t){e.amount=t},expression:"amount"}}),r("div",{staticClass:"pop-balance"},[e._v("MAI: "+e._s(e.$gbUtils.formatBalance(e.balance)))]),r("div",{staticClass:"pop-tips"},[e._v(e._s(e.$t("otc.hangBuyTip",{num:e.minAmount})))]),r("div",{staticClass:"pop-tips"},[e._v(" "+e._s(e.$t("otc.expectedToObtain",{num:e.needAll})))]),e.auth?r("van-button",{staticClass:"pop-btn",attrs:{loading:e.hangLoading,disabled:e.price<=0||e.amount<+e.minAmount||e.amount>+e.balance},on:{click:e.handlePending}},[e._v(e._s(e.$t("otc.submitHang")))]):r("van-button",{staticClass:"pop-btn",attrs:{loading:e.approveLoading},on:{click:e.approve}},[e._v(e._s(e.$t("otc.approve")))])],1),r("div",{staticClass:"close-icon",on:{click:e.handleClose}},[r("img",{attrs:{src:n("cd5c")}})])])},w=[],x={name:"",props:["lastPrice"],data:function(){return{show:!0,type:2,price:"",amount:"",tokenAddress:"",hangLoading:!1,balance:0,minAmount:0,auth:!1,approveLoading:!0}},computed:{needAll:function(){return this.price*this.amount||0}},methods:{formatterNum:function(e){return e.replace(/[^0-9.]/g,"").replace(/^(-)*(\d+)\.(\d\d).*$/,"$1$2.$3")},handleClose:function(){this.$emit("close")},init:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.getMinAmount(),t.next=3,e.gettokenAddress();case 3:e.getBalance(),e.getAllowance();case 5:case"end":return t.stop()}}),t)})))()},getMinAmount:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i["a"].MIN_AMOUNT();case 2:if(n=t.sent,n.success){t.next=5;break}return t.abrupt("return");case 5:e.minAmount=n.result||0;case 6:case"end":return t.stop()}}),t)})))()},gettokenAddress:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i["a"].MAI();case 2:if(n=t.sent,n.success){t.next=5;break}return t.abrupt("return");case 5:e.tokenAddress=n.result;case 6:case"end":return t.stop()}}),t)})))()},getBalance:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.tokenAddress){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.$web3.balanceOf(e.tokenAddress);case 4:if(n=t.sent,n.success){t.next=7;break}return t.abrupt("return");case 7:e.balance=n.result||0;case 8:case"end":return t.stop()}}),t)})))()},handleMax:function(){this.amount=this.balance},getAllowance:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.approveLoading=!0,t.next=3,p["a"].allowance(e.tokenAddress,d["a"].otc);case 3:if(n=t.sent,e.approveLoading=!1,n.success){t.next=7;break}return t.abrupt("return");case 7:e.auth=n.result>0;case 8:case"end":return t.stop()}}),t)})))()},approve:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.approveLoading=!0,t.next=3,p["a"].approve(e.tokenAddress,d["a"].otc);case 3:if(n=t.sent,e.approveLoading=!1,n.success){t.next=7;break}return t.abrupt("return",e.$toast("fail"));case 7:e.$toast("Success"),e.auth=!0;case 9:case"end":return t.stop()}}),t)})))()},handlePending:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.hangLoading=!0,t.next=3,i["a"].pending(e.type,e.price,e.amount);case 3:if(n=t.sent,e.hangLoading=!1,n.success){t.next=7;break}return t.abrupt("return");case 7:e.$emit("close"),e.$parent.init();case 9:case"end":return t.stop()}}),t)})))()}},mounted:function(){this.init()}},k=x,_=Object(f["a"])(k,g,w,!1,null,"28760198",null),$=_.exports,y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"total-box"},[n("div",{staticClass:"order-item"},[e._v(e._s(e.price))]),n("div",{staticClass:"order-item"},[e._v(e._s(e.$gbUtils.formatBalance(e.totalAmount)))]),n("div",{staticClass:"order-item"},[n("van-button",{staticClass:"check-item",on:{click:e.handleCheck}},[e._v(e._s(1===e.type?e.$t("otc.sell"):e.$t("otc.purchase")))])],1),e.priceListShow?n("OrderPriceList",{attrs:{price:e.price,type:e.type},on:{close:e.handleCheck,handleTrade:e.handleTrade}}):e._e(),e.tradeShow?n("TradePop",{attrs:{id:e.curId,type:e.curType,orderInfo:e.curInfo},on:{close:function(){e.tradeShow=!1}}}):e._e()],1)},A=[],C=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("VanPopup",{staticClass:"otc-pop",staticStyle:{background:"transparent",width:"80%","max-width":"375px","min-width":"300px"},on:{"click-overlay":e.close},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[r("div",{staticClass:"pop-body"},[r("div",{staticClass:"pop-title"},[e._v(e._s(e.price)+" "+e._s(1===e.type?e.$t("otc.buy"):e.$t("otc.sale")))]),r("van-checkbox-group",{model:{value:e.batchId,callback:function(t){e.batchId=t},expression:"batchId"}},e._l(e.idList,(function(t,n){return r("van-checkbox",{key:t,staticClass:"check-box",attrs:{"checked-color":"#6667FF",name:t}},[r("OrderPriceInfo",{attrs:{index:n,id:t,price:e.price,type:e.type},on:{handleTrade:e.handleTrade,handleHideItem:e.handleHideItem}})],1)})),1),e.auth?r("van-button",{staticClass:"pop-btn",attrs:{disabled:!e.batchId.length,loading:e.batchLoading},on:{click:e.handleBatchTrade}},[e._v(e._s(1===e.type?e.$t("otc.batchSell"):e.$t("otc.batchBuy")))]):r("van-button",{staticClass:"pop-btn",attrs:{loading:e.approveLoading},on:{click:e.approve}},[e._v(e._s(e.$t("otc.approve")))])],1),r("div",{staticClass:"close-icon",on:{click:e.close}},[r("img",{attrs:{src:n("cd5c")}})])])},I=[],O=(n("a434"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"flex-box"},[n("div",{staticClass:"amount"},[e._v(e._s(e.$gbUtils.formatBalance(e.orderInfo.remain||0))+" MAI")]),n("VanButton",{staticClass:"pop-btn",on:{click:e.handleTrade}},[e._v(e._s(2===e.type?e.$t("otc.purchase"):e.$t("otc.sell")))])],1)}),R=[],L={name:"",props:["id","price","type","index"],data:function(){return{orderInfo:{}}},methods:{getOrderInfo:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i["a"].getOrderInfo(e.id);case 2:if(n=t.sent,n.success){t.next=5;break}return t.abrupt("return");case 5:e.orderInfo={direct:n.result.direct,price:e.$web3.fromWei(n.result.price),total:e.$web3.fromWei(n.result.total),remain:e.$web3.fromWei(n.result.remain),token:n.result.token,sender:n.result.sender,status:n.result.status},e.orderInfo.remain<=0&&e.$emit("handleHideItem",e.index);case 7:case"end":return t.stop()}}),t)})))()},handleTrade:function(){this.$emit("handleTrade",this.type,this.id,this.orderInfo)}},mounted:function(){this.getOrderInfo()}},P=L,T=(n("21e3"),Object(f["a"])(P,O,R,!1,null,"4a3ab934",null)),S=T.exports,M={name:"",props:["price","type"],components:{OrderPriceInfo:S},data:function(){return{show:!0,idList:[],batchId:[],batchLoading:!1,tokenAddress:"",auth:!1,approveLoading:!0}},methods:{close:function(){this.$emit("close")},init:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.getIdList(),t.next=3,e.gettokenAddress();case 3:e.getAllowance();case 4:case"end":return t.stop()}}),t)})))()},handleHideItem:function(e){this.idList.splice(e,1)},getIdList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i["a"].getMarketIds(e.type,e.price);case 2:if(n=t.sent,n.success){t.next=5;break}return t.abrupt("return");case 5:e.idList=(n.result||[]).map((function(e){return e}));case 6:case"end":return t.stop()}}),t)})))()},gettokenAddress:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(2!==e.type){t.next=6;break}return t.next=3,i["a"].MUSD();case 3:t.t0=t.sent,t.next=9;break;case 6:return t.next=8,i["a"].MAI();case 8:t.t0=t.sent;case 9:if(n=t.t0,n.success){t.next=12;break}return t.abrupt("return");case 12:e.tokenAddress=n.result;case 13:case"end":return t.stop()}}),t)})))()},getAllowance:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.approveLoading=!0,t.next=3,p["a"].allowance(e.tokenAddress,d["a"].otc);case 3:if(n=t.sent,e.approveLoading=!1,n.success){t.next=7;break}return t.abrupt("return");case 7:e.auth=n.result>0;case 8:case"end":return t.stop()}}),t)})))()},approve:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.approveLoading=!0,t.next=3,p["a"].approve(e.tokenAddress,d["a"].otc);case 3:if(n=t.sent,e.approveLoading=!1,n.success){t.next=7;break}return t.abrupt("return",e.$toast("fail"));case 7:e.$toast("Success"),e.auth=!0;case 9:case"end":return t.stop()}}),t)})))()},handleBatchTrade:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.batchLoading=!0,t.next=3,i["a"].batchTrade(e.batchId);case 3:if(n=t.sent,e.batchLoading=!1,n.success){t.next=7;break}return t.abrupt("return");case 7:e.$emit("close"),e.$parent.init(),e.$parent.$parent.init();case 10:case"end":return t.stop()}}),t)})))()},handleTrade:function(e,t,n){this.close(),this.$emit("handleTrade",e,t,n)}},mounted:function(){this.init()}},j=M,B=(n("5c51"),Object(f["a"])(j,C,I,!1,null,"26232142",null)),N=B.exports,U=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("VanPopup",{staticClass:"otc-pop",staticStyle:{background:"transparent",width:"80%","max-width":"375px","min-width":"300px"},on:{"click-overlay":e.close},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[r("div",{staticClass:"pop-body"},[r("div",{staticClass:"pop-title"},[e._v(e._s(2===e.type?e.$t("otc.purchase"):e.$t("otc.sell")))]),r("van-field",{staticClass:"pop-input",attrs:{disabled:"","input-align":"right",type:"number",label:e.$t("otc.price")},scopedSlots:e._u([{key:"button",fn:function(){return[e._v("MUSD")]},proxy:!0}]),model:{value:e.orderInfo.price,callback:function(t){e.$set(e.orderInfo,"price",t)},expression:"orderInfo.price"}}),r("van-field",{staticClass:"pop-input",attrs:{disabled:"","input-align":"right",type:"number",label:e.$t("otc.total")},scopedSlots:e._u([{key:"button",fn:function(){return[e._v("MAI")]},proxy:!0}]),model:{value:e.orderInfo.remain,callback:function(t){e.$set(e.orderInfo,"remain",t)},expression:"orderInfo.remain"}}),r("van-field",{staticClass:"pop-input",attrs:{"input-align":"right",type:"number",label:2===e.type?e.$t("otc.buyNum"):e.$t("otc.sellNum"),placeholder:e.$t("otc.pleaseInput")},scopedSlots:e._u([{key:"button",fn:function(){return[r("van-button",{staticClass:"max-btn",attrs:{size:"small",color:"#5E12E7"},on:{click:e.handleMax}},[e._v("Max")])]},proxy:!0}]),model:{value:e.amount,callback:function(t){e.amount=t},expression:"amount"}}),r("div",{staticClass:"pop-balance"},[e._v(e._s(1===e.type?"MAI":"MUSD")+": "+e._s(e.$gbUtils.formatBalance(e.balance)))]),r("div",{staticClass:"pop-tips"},[e._v(" "+e._s(e.$t("otc.tradeTips",{num1:e.canTradeNum,num2:e.orderInfo.remain}))+"("+e._s(e.$t("otc.remainingTip",{num:e.minAmount}))+")")]),r("div",{staticClass:"pop-tips"},[1===e.type?r("span",[e._v(e._s(e.$t("otc.expectedToObtain",{num:e.needAll})))]):e._e(),2===e.type?r("span",[e._v(" "+e._s(e.$t("otc.estimatedConsumption",{num:e.needAll})))]):e._e()]),e.auth?r("van-button",{staticClass:"pop-btn",attrs:{disabled:e.amount<=0||e.amount>e.canTradeNum&&e.amount!=+e.orderInfo.remain||e.amount>+e.orderInfo.remain,loading:e.tradeLoading},on:{click:e.handleTrade}},[e._v(e._s(1===e.type?e.$t("otc.sell"):e.$t("otc.purchase")))]):r("van-button",{staticClass:"pop-btn",attrs:{loading:e.approveLoading},on:{click:e.approve}},[e._v(e._s(e.$t("otc.approve")))])],1),r("div",{staticClass:"close-icon",on:{click:e.close}},[r("img",{attrs:{src:n("cd5c")}})])])},E=[],H={name:"",props:["id","type","orderInfo"],data:function(){return{show:!0,amount:null,tokenAddress:"",hangLoading:!1,balance:0,minAmount:0,auth:!1,approveLoading:!0,tradeLoading:!1}},computed:{needAll:function(){return this.orderInfo.price*this.amount||0},canTradeNum:function(){return+this.orderInfo.remain-this.minAmount}},methods:{close:function(){this.$emit("close")},handleMax:function(){if(2===this.type){var e=this.orderInfo.price*this.orderInfo.remain,t=this.balance/this.orderInfo.price;this.amount=this.balance>=e?this.orderInfo.remain:t>=this.canTradeNum?this.canTradeNum:t}else this.amount=this.balance>=this.orderInfo.remain?this.orderInfo.remain:this.balance>=this.canTradeNum?this.canTradeNum:this.balance},init:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.getMinAmount(),t.next=3,e.gettokenAddress();case 3:e.getBalance(),e.getAllowance();case 5:case"end":return t.stop()}}),t)})))()},getMinAmount:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i["a"].MIN_REMAIN_AMOUNT();case 2:if(n=t.sent,n.success){t.next=5;break}return t.abrupt("return");case 5:e.minAmount=n.result||0;case 6:case"end":return t.stop()}}),t)})))()},gettokenAddress:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(2!==e.type){t.next=6;break}return t.next=3,i["a"].MUSD();case 3:t.t0=t.sent,t.next=9;break;case 6:return t.next=8,i["a"].MAI();case 8:t.t0=t.sent;case 9:if(n=t.t0,n.success){t.next=12;break}return t.abrupt("return");case 12:e.tokenAddress=n.result;case 13:case"end":return t.stop()}}),t)})))()},getBalance:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.tokenAddress){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.$web3.balanceOf(e.tokenAddress);case 4:if(n=t.sent,n.success){t.next=7;break}return t.abrupt("return");case 7:e.balance=n.result||0;case 8:case"end":return t.stop()}}),t)})))()},getAllowance:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.approveLoading=!0,t.next=3,p["a"].allowance(e.tokenAddress,d["a"].otc);case 3:if(n=t.sent,e.approveLoading=!1,n.success){t.next=7;break}return t.abrupt("return");case 7:e.auth=n.result>0;case 8:case"end":return t.stop()}}),t)})))()},approve:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.approveLoading=!0,t.next=3,p["a"].approve(e.tokenAddress,d["a"].otc);case 3:if(n=t.sent,e.approveLoading=!1,n.success){t.next=7;break}return t.abrupt("return",e.$toast("fail"));case 7:e.$toast("Success"),e.auth=!0;case 9:case"end":return t.stop()}}),t)})))()},handleTrade:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.tradeLoading=!0,t.next=3,i["a"].trade(e.id,e.amount);case 3:if(n=t.sent,e.tradeLoading=!1,n.success){t.next=7;break}return t.abrupt("return");case 7:e.$emit("close"),e.$parent.init(),e.$parent.$parent.init();case 10:case"end":return t.stop()}}),t)})))()}},mounted:function(){this.init()}},D=H,z=Object(f["a"])(D,U,E,!1,null,"ab51f63a",null),V=z.exports,W={name:"",props:["price","type"],components:{OrderPriceList:N,TradePop:V},data:function(){return{totalAmount:0,priceListShow:!1,tradeShow:!1,curId:"",curType:"",curInfo:"",timer:null}},watch:{price:function(e){this.init()}},methods:{init:function(){this.getPriceTotals()},getPriceTotals:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i["a"].getPriceTotals(e.type,e.price);case 2:if(n=t.sent,n.success){t.next=5;break}return t.abrupt("return");case 5:e.totalAmount=n.result||0;case 6:case"end":return t.stop()}}),t)})))()},handleCheck:function(){this.priceListShow=!this.priceListShow},handleTrade:function(e,t,n){this.curType=e,this.curId=t,this.curInfo=n,this.tradeShow=!0},initTimer:function(){var e=this;this.timer=setInterval((function(){e.init()}),15e3)}},mounted:function(){this.init(),this.initTimer()},beforeDestroy:function(){clearInterval(this.timer),this.timer=null}},F=W,J=(n("8346"),Object(f["a"])(F,y,A,!1,null,"e908f6ea",null)),q=J.exports,G={name:"",components:{HangBuy:b,HangSale:$,OrderPiceTotal:q},props:["type","lastPrice"],data:function(){return{hangPopShow:!1,priceList:[],offset:0,size:10,num:1,timer:null}},methods:{handleShowHang:function(){this.hangPopShow=!this.hangPopShow},getList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i["a"].getMarketPrices(e.type,e.offset,e.size);case 2:if(n=t.sent,n.success){t.next=5;break}return t.abrupt("return");case 5:r=(n.result||[]).map((function(t){return e.$web3.fromWei(t)})),1===e.type?r.sort((function(e,t){return t-e})):r.sort((function(e,t){return e-t})),e.priceList=r;case 8:case"end":return t.stop()}}),t)})))()},init:function(){this.getList()},initTimer:function(){var e=this;this.timer=setInterval((function(){e.init()}),15e3)}},mounted:function(){this.init(),this.initTimer()},beforeDestroy:function(){clearInterval(this.timer),this.timer=null}},K=G,Q=(n("5387"),Object(f["a"])(K,c,o,!1,null,"4e198dea",null)),X=Q.exports,Y={name:"",components:{OrderBox:X},data:function(){return{lastPrice:0,type:2}},methods:{getLastPrice:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i["a"].lastPrice();case 2:if(n=t.sent,n.success){t.next=5;break}return t.abrupt("return");case 5:e.lastPrice=n.result;case 6:case"end":return t.stop()}}),t)})))()},init:function(){this.getLastPrice()}},mounted:function(){this.init()}},Z=Y,ee=(n("f787"),Object(f["a"])(Z,r,a,!1,null,"1c9ec52d",null));t["default"]=ee.exports},edc3:function(e,t,n){},f787:function(e,t,n){"use strict";n("2248")}}]);
//# sourceMappingURL=chunk-3c97ad09.54836802.js.map